
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:bib="http://bibtexml.org/STSCHEMA" xmlns:adr="http://tbookdtd.sourceforge.net/addressbook" xmlns:ref="http://tbookdtd.sourceforge.net/references" xmlns:index="http://tbookdtd.sourceforge.net/index" xmlns:dimensions="http://tbookdtd.sourceforge.net/dimension-file" xmlns:depths="http://tbookdtd.sourceforge.net/depths-file" xmlns:loc="local" xmlns:CSS="http://www.w3.org/1998/Style/CSS2"><head>
      <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <title>PyTables User's Guide</title><meta http-equiv="Content-Type" content="text/html"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="generator" content="The tbook system at http://tbookdtd.sourceforge.net"><meta name="robots" content="index"><meta name="DC.Title" content="PyTables User's Guide"><meta name="DC.Description" content="PyTables User's Guide"><meta name="DC.Creator" content="Francesc Alted"><meta name="Author" content="Francesc Alted"><meta name="DC.Date" content="2002-11-15T18:10:02Z"><meta name="Date" content="2002-11-15T18:10:02Z"><meta name="DC.Rights" content="(c) 2002 Francesc Alted"><meta name="Copyright" content="(c) 2002 Francesc Alted"><meta name="DC.Type" content="Text"><meta name="DC.Format" content="text/html"><meta name="DC.Language" scheme="rfc3066" content="en"><meta name="Language" content="en"><meta http-equiv="Content-Style-Type" content="text/css"><style type="text/css">
    body {
      font-family: serif; text-align: justify;
      margin: 0pt; line-height: 1.3; background-color: white; color: black }
    body.letter { background-image: none }
    h1, h2, h3, h4, h5, h6, div.partheadline, div.title,
      div.title-article {
      font-family: sans-serif; font-weight: bold; font-stretch: condensed;
      text-align: left; }
    h1, h2, h3, h4, h5, h6, div.partheadline { padding-left: 18pt }
    h1 { clear: both }
    h1.toc { clear: none }
    div.document, div.letter { margin-left: 80px; margin-right: 150px;
      padding-top: 3ex; padding-bottom: 5ex }
    div.authorlist { font-family: sans-serif;
      font-stretch: condensed; text-align: left; font-size: x-large;
      margin-bottom: 1ex }
    div.authorlist-article { font-size: x-large; text-align: center;
      margin-bottom: 2ex }
    div.title { font-size: xx-large; color: gray; margin-bottom: 5ex; }
    div.title-article { font-size: xx-large; text-align: center;
      margin-bottom: 2ex }
    div.date-article { font-size: large; text-align: center;
      margin-bottom: 5ex }
    div.subtitle { text-align: left; margin-bottom: 3ex }
    div.legal { text-align: right }
    div.partheadline { font-size: xx-large; margin-top: 1ex; margin-bottom: 1ex }
    div.footnote { }
    div.mathdisplay { text-align: center;
    margin-top: 2ex; margin-bottom: 2ex }
    div.figure, div.table, div.mathml-remark { margin-bottom: 3ex;
            margin-top: 2ex}
    div.mathml-remark { width: 50%; text-align: left; text-indent: 0pt }
    div.caption { margin-top: 1ex; width: 20em}
    div.caption-text { font-size: small;
      padding-left: 1em; text-indent: -1em; text-align: justify}
    caption { max-width: 100%; min-width: 200px; margin-bottom: 1ex;
      text-align: justify }
    div.verse { white-space: pre }
    div.toc { margin-bottom: 6ex }
    div.biblio, div.index { }
    div.aphorism { margin-bottom: 2ex; font-style: italic; text-align: right;
      margin-left: 50%}
    div.aphorism-origin { margin-top: 1ex }
    div.letter { }
    div.subject { margin-top: 3ex; margin-bottom: 3ex }
    div.opening { margin-top: 3ex; margin-bottom: 3ex }
    div.closing { margin-top: 3ex; text-align: right }
    div.to { margin-top: 3ex; margin-bottom: 3ex }
    span.subject { font-weight: bold }
    div.speedbar-top, div.speedbar-bottom { margin-left: 1em; margin-right: 1em }
    div.speedbar-top { margin-top: 2ex }
    div.speedbar-bottom { margin-bottom: 3ex }
    table.speedbar { width: 100% }
    hr.speedbar { clear: both }
    div.theorem-plain, div.theorem-definition, div.theorem-remark { margin-top: 2ex;
      margin-bottom: 2ex }
    div.theorem-plain { font-style: italic }
    div.proof { margin-top: 2ex; margin-bottom: 2ex }
    span.theorem-head-plain, span.theorem-head-definition, span.theorem-head-remark
      { margin-right: 0.66em }
    span.theorem-head-plain, span.theorem-head-definition
      { font-style: normal; font-weight: bold }
    span.theorem-head-remark { font-style: italic }
    span.proof-head { font-style: italic; margin-right: 0.66em }
    acronym { font-size: 95%; letter-spacing: 0.1em; text-transform: uppercase }
    td.header { text-align: center; font-weight: bold }
    table.toc { }
    table.tabular { font-size: smaller }
    td.thickline { height: 0pt; border-bottom: medium solid; padding: 2px }
    td.thinline { height: 0pt; border-bottom: thin solid;   padding: 2px }
     /* FixMe: Following definition Still bad */
    div.part-toc { margin-top: 2ex; font-weight: bold; font-size: larger }
     /* FixMe: Following definition: How cleaner? */
    div.toplevel-toc { margin-top: 1ex; font-weight: bold }
    td.number1 { width: 1.5em }
    td.number2 { width: 2em }
    td.number3 { width: 3em }
    td.author { text-align: center }
    div { }  /* Must remain empty! */
    span.captionlabel { font-family: sans-serif; font-weight: bold;
      margin-right: 0.66em }
    span.captionlabel:after { content: " " }
    b.captionlabel {  }
    b.captionlabel:after { content: " " }
    span.headlinenumber { margin-right: 0.66em }
    tt.verb {font-family: monospace }
    span.bibtag { font-weight: bold; margin-right: 1em }
    span.bib-author { }
    span.bib-lastname { font-variant: small-caps }
    span.bib-title { font-style: italic }
    span.bib-booktitle { }
    span.bib-journal { }
    span.bib-journal-volume { font-weight: bold }
    span.bib-publisher { }
    span.bib-school { }
    span.bib-year { }
    span.bib-note { }
    span { } /* Muss leer bleiben! */
    li.bibitem { margin-left: 1em; text-indent: -1em }
    img.graphics { border: 0pt }
    p,div.p { margin: 0pt; text-indent: 18pt }
    ul, dl, ol { text-indent: 0pt; }
    p.first, div.p-first { margin: 0pt; text-indent: 0pt }
    p.bibitem { margin-top: 1.5ex; margin-left: 3em; text-indent: -3em }
    ul.biblio { list-style: none }
    mi.ch { font-style: normal }
    math[display="block"], div.equation {
      margin-top: 1ex; margin-bottom: 1ex }
    div.i-lettergroup { font-size: larger; font-weight: bold; padding-left: 18pt;
      margin-top: 3ex; margin-bottom: 1.5ex }
    div.i-item { }
    div.i-main { }
    dt { display: compact; font-weight: bold }
    dd { text-indent: 0pt }
    pre { text-indent: 0pt }
    span.i-see { font-style: italic; }
</style></head><body bgcolor="#FFFFFF"><div class="speedbar-top"><table class="speedbar"><tr><td style="text-align: left; width: 15%">&nbsp;</td><td style="text-align: center"><a href="usersguide-html.html#tb:table-of-contents">Table of Contents</a> &#8212; <a href="usersguide-html6.html">References</a></td><td style="text-align: right; width: 15%"><a href="usersguide-html2.html">next</a></td></tr><tr><td colspan="3">&nbsp;</td></tr></table><hr class="speedbar"></div><div class="document"><div>
      <h1 id="chapter1"><a name="chapter1"></a>Chapter&nbsp;1: Introduction</h1>

      <div class="aphorism">La sabidur&iacute;a no vale la pena si no es posible servirse
	de ella para inventar una nueva manera de preparar los
	garbanzos.<div class="aphorism-origin">&#8212;Un sabio catal&aacute;n<br> in "Cien a&ntilde;os de
	soledad"<br> Gabriel Garc&iacute;a
	M&aacute;rquez</div>
      </div>

      <p class="first">The goal of <tt class="verb">PyTables</tt> is to enable the end user
	to manipulate easily scientific data <b>tables</b> and <em>Numerical Python</em> (
	see <a href="usersguide-html6.html#Numerical">Ascher <em>et&nbsp;al.</em> ()</a>) objects in a hierarchical
	structure. The foundation of the underlying hierarchical data
	organization is the excellent <tt class="verb">HDF5</tt> library (see
	<a href="usersguide-html6.html#HDFWhatIs">NCSA (<em>c</em>)</a> and <a href="usersguide-html6.html#HDFIntr">NCSA (<em>b</em>)</a>). Right now, <tt class="verb">PyTables</tt> provides
	limited support of all the HDF5 functions, but I hope to add
	the more interesting ones (for <tt class="verb">PyTables</tt> needs) in
	the near future. Nonetheless, this package is not intended to
	serve as a complete wrapper for the entire HDF5 API.
      </p>

      <p>A table is defined as a collection of records whose values
	are stored in <em>fixed-length</em> fields. All records have
	the same structure and all values in each field have the same
	<em>data type</em>. The terms <em>fixed-length</em> and
	strict <em>data types</em> seems to be quite a strange
	requirement for an interpreted language like Python, but they
	serve a useful function if the goal is to save very large
	quantities of data (such as is generated by many scientific
	applications, for example) in an efficient manner that reduces
	demand on CPU time and I/O.
      </p>

      <p>In order to emulate records (that will be mapped to C structs
	in HDF5) in Python <tt class="verb">PyTables</tt> implements a special
	<em>metaclass</em> object with the capability to detect errors
	in field assignments as well as type and range
	overflows. <tt class="verb">PyTables</tt> also provides a powerful
	interface to process table data. Records in tables are also
	known, in the <tt class="verb">HDF5</tt> naming scheme, as
	<em>compound</em> data types. See <a href="usersguide-html6.html#HDF5TableExamples">NCSA (<em>a</em>)</a> for examples in HDF5 tables
	(in C language!).
      </p>

      <p>For example, you can define arbitrary records in Python
	simply by declaring a class with the name field and types
	information, like in:
      </p>

<pre>
class Particle(IsRecord):
    name        = '16s'  # 16-character String
    idnumber    = 'Q'    # unsigned long long (i.e. 64-bit integer)
    TDCcount    = 'B'    # unsigned byte
    ADCcount    = 'H'    # unsigned short integer
    grid_i      = 'i'    # integer
    grid_j      = 'i'    # integer
    pressure    = 'f'    # float  (single-precision)
    energy      = 'd'    # double (double-precision)

</pre>

      <p>then, you will normally instantiate that class, fill the
	instance with your values, and save (arbitrary large)
	collections of them in a file for persistent storage. After
	that, this data can be retrieved and post-processed quite
	easily with <tt>PyTables</tt> or even with
	another <tt class="verb">HDF5</tt> application.
      </p>

      <p>Next section describes the most interesting capabilities of
	<tt class="verb">PyTables</tt>.</p>

      <div>
	<h2><span class="headlinenumber" id="section1.1"><a name="section1.1"></a>1.1 </span>Main Features</h2> <p class="first"><tt>PyTables</tt> has the next capabilities:</p>

	<ul>
	  <li><em>Support of table entities:</em> Allows working
	    with a large number of records, i.e. that don't fit in
	    memory.
	  </li>
	  <li><em>Support of <tt>Numerical
		Python</tt> arrays:</em> <tt class="verb">Numeric</tt>
		arrays are a very useful complement of tables to keep
		homogeneous table slices (like selections of table
		columns).
	  </li>
	  <li><em>Supports a hierarchical data model:</em> That way,
	    you can structure very clearly all your
	    data. <tt class="verb">PyTables</tt> builds up an <em>object
	    tree</em> in memory that replicates the underlying file
	    data structure. Access to the file objects is achieved by
	    walking throughout this object tree, and manipulating it.
	  </li>
	  <li><em>Incremental I/O:</em> It supports adding records
	    to already created tables. So you won't need to book large
	    amounts of memory to fill the entire table and then save
	    it to disk but you can do that incrementally, even between
	    different Python sessions.
	  </li>
	  
	  <li><em>Appendable tables:</em> It supports adding records
	    to already created tables. This can be done without copying the
	    dataset or redefining its structure, even between different
	    Python sessions.
	  </li>
			    
	  <li><em>Automatically check for correct field name, data
	    type and data range:</em> That reduces programmer mistakes
	    and if <tt>PyTables</tt> does not
	    report an error, you can be more confident that your data
	    is probably ok.
	  </li>
	  <li><em>Support of files bigger than 2 GB:</em> The
	    underlying HDF5 library already can do that (if your
	    platform supports the C long long integer, or, on Windows,
	    __int64), and <tt class="verb">PyTables</tt> automatically inherits
	    this capability.
	  </li>
	  <li><em>Data compression:</em> It supports data
	    compression (through the use of the <tt><b>zlib</b></tt>
	    library) out of the box. This become important when you
	    have repetitive data patterns and don't want to loose your
	    time searching for an optimized way to save them (i.e. it
	    saves you data organization analysis time). This feature
	    is also inherited from HDF5.
	  </li>
	  <li><em>Architecture-independent:</em> <tt>PyTables</tt> has been carefully coded (as
	    HDF5 itself) with little-endian/big-endian byte orderings issues
	    in mind. So, in principle, you can write a file in a big-endian
	    machine (like a Sparc or MIPS) and read it in other
	    little-endian (like Intel or Alpha)
	    without problems<a href="#footnote1" name="footnoteback1"><sup>1)</sup></a>.</li>
	</ul>

	<p>It should noted that <tt>PyTables</tt>
	  is not intended to merely be a high level wrapper of
	  selected HDF5 functionality (for this, have a look at
	  HL-HDF5, the Swedish Meteorological and Hydrological
	  Institute effort to provide another Python interface to
	  HDF5; see <a href="usersguide-html6.html#HL-HDF">Henja and Michelson ()</a>), but to
	  provide a flexible, <em>very Pythonic</em> tool to deal with
	  (arbitrary) large amounts of data (typically bigger than
	  available memory) in tables and arrays organized in a
	  hierarchical, persistent disk storage.
	</p>
	<p>
	  <tt class="verb">PyTables</tt> take advantage of the powerful object
	  orientation and introspection capabilities offered by Python
	  to bring all those exposed features to the user in a
	  friendly manner.
	</p>
      </div>

      <div id="NaturalTreeSection"><a name="NaturalTreeSection"></a>
	<h2><span class="headlinenumber" id="section1.2"><a name="section1.2"></a>1.2 </span>The Object Tree</h2>

	<p class="first">The hierarchical model of the underlying HDF5 library
	  allows <tt class="verb">PyTables</tt> to manage tables and arrays in
	  a tree-like structure. In order to achieve this, an
	  <em>object tree</em> entity is <em>dynamically</em> created
	  imitating the HDF5 structure on disk. That way, the access
	  to the HDF5 objects is made by walking throughout this
	  object tree, and, by looking at their <em>metadata</em>
	  nodes, you can get a nice picture of what kind data is kept
	  there.
	</p>

	<p>The different nodes in the object tree are instances of
	  <tt class="verb">PyTables</tt> classes. There are several types of
	  those classes, but the most important ones are the
	  <tt class="verb">Group</tt> and the
	  <tt class="verb">Leaf</tt>. <tt class="verb">Group</tt> instances (that we
	  will be calling <em>groups</em> from now on) are a grouping
	  structure containing instances of zero or more groups or
	  leaves, together with supporting metadata. <tt class="verb">Leaf</tt>
	  instances (that will be called <em>leaves</em>) are
	  containers for actual data and cannot contain any other
	  instances<a href="#footnote2" name="footnoteback2"><sup>2)</sup></a>. The <tt class="verb">Table</tt> and
	  <tt class="verb">Array</tt> classes are descendants of
	  <tt class="verb">Leaf</tt>, and inherits all its properties.
	</p>

	<p>Working with groups and leaves is similar in many ways to
	  working with directories and files, respectively, in a Unix
	  filesystem. As with Unix directories and files, objects in
	  the object tree are often described by giving their full (or
	  absolute) path names. In <tt class="verb">PyTables</tt> this full
	  path can be specified either as string (like in
	  <tt class="verb">'/subgroup2/table3'</tt>) or as a complete object
	  path written in a certain way known as <em>natural name</em>
	  schema (like in <tt class="verb">file.root.subgroup2.table3</tt>).
	</p>

	<p>The support for <em>natural naming</em> is a key aspect of
	  <tt class="verb">PyTables</tt> and means that the names of instance
	  variables of the node objects are the same as the names of
	  the element's children<a href="#footnote3" name="footnoteback3"><sup>3)</sup></a>. This is very
	  <em>Pythonic</em> and comfortable in many cases, as you can
	  check in the tutorial <a href="usersguide-html3.html#readingAndSelectingUsage">section&nbsp;3.1.6</a>.
	</p>
	<p>You should also note that not all the data present on file
	  is loaded in the object tree, but only the <em>metadata</em>
	  (i.e. special data that describes the structure of the
	  actual data). The actual data is not read until you ask for
	  it (by calling a method in a particular node). By making use
	  of the object tree (the metadata) you can get information on
	  the objects on disk such as table names, title, name fields,
	  data types in fields, number of records, or, in the case of
	  arrays, shapes, typecode, and so on. You can also traverse
	  the tree in order to search for something and when you find
	  the data you are interested in you can read it and process
	  it. In some sense, you can think of <tt class="verb">PyTables</tt> as
	  a tool that provide the same introspection capabilities of
	  Python objects, but applied to the persistent storage of
	  large amounts of data.
	</p>
	<p>To better understand the dynamic nature of this object tree
	  entity, imagine that we have made a script (in fact, this
	  script actually exists and you can find it in
	  <tt class="verb">examples/objecttree.py</tt>; check it out!) that
	  creates a simple <tt class="verb">PyTables</tt> file, with the
	  structure that appears in <a href="#objecttree-h5">figure&nbsp;1.1</a>. During creation time,
	  metadata in the object tree is updated in memory while the
	  actual data is being saved on disk and when you close the
	  file the object tree becomes unavailable. But, when you will
	  open again this file the object tree with will be
	  re-constructed in memory from the metadata existent on disk,
	  so that you can work with it exactly in the same way than
	  during the original creation process.
	</p>

	<div class="figure" id="objecttree-h5"><a name="objecttree-h5"></a>
	
	  <a target="_blank" href="objecttree-h5.png"><img class="graphics"
	  alt="An HDF5 example with 2 subgroups and
	  3 tables (Click for original bitmap)" src="objecttree-h5-web.png"></a>
	  
	  <div class="caption" style="width: 800px"><div class="caption-text"><span class="captionlabel">Figure&nbsp;1.1:</span> An HDF5 example with 2 subgroups and 3 tables.</div></div>
	</div>

	<p>In <a href="#objecttree">figure&nbsp;1.2</a> you can see an
	  example of the object tree created by reading a
	  <tt class="verb">PyTables</tt> file (in fact, this file is the same
	  as that of the <a href="#objecttree-h5">figure&nbsp;1.1</a>). If
	  you are going to become a <tt>PyTables</tt> user, take your time to
	  understand it<a href="#footnote4" name="footnoteback4"><sup>4)</sup></a>. That will also make you more proactive by
	  avoiding programming mistakes.
	</p>

	<div class="figure" id="objecttree"><a name="objecttree"></a>
	  
	  <img class="graphics" width="658" height="806" alt="An object tree example in PyTables.&#xA;	  " src="objecttree-web.png">
	  <div class="caption" style="width: 658px"><div class="caption-text"><span class="captionlabel">Figure&nbsp;1.2:</span> An object tree example in <tt>PyTables</tt>.
	  </div></div>
	</div>

      </div>

    </div><hr align="left" noshade="true" style="text-align: left; width: 20%; color: black"><div class="footnote"><a name="footnote1" href="#footnoteback1"><sup>1)</sup></a>&nbsp;I do actually tested that
	    between a Sparc machine (big-endian) and an Intel machine
	    (little-endian) and it works only for tables but not for
	    arrays!. This flaw will hopefully be addressed in next
	    release.</div><div class="footnote"><a name="footnote2" href="#footnoteback2"><sup>2)</sup></a>&nbsp;Except <tt class="verb">Attribute</tt> instances
	  in the short future</div><div class="footnote"><a name="footnote3" href="#footnoteback3"><sup>3)</sup></a>&nbsp;I have got this simple but
	  powerful idea from the excellent <tt>Objectify</tt> module by David Mertz (see
	  references <a href="usersguide-html6.html#Objectify">Mertz (<em>b</em>)</a> and <a href="usersguide-html6.html#GnosisUtils">Mertz (<em>a</em>)</a>)</div><div class="footnote"><a name="footnote4" href="#footnoteback4"><sup>4)</sup></a>&nbsp;Bear in mind, however, that this
	  diagram is <b>not</b> a standard UML
	  class diagram; I've used an UML tool to draw it, that's
	  all.</div></div><div class="speedbar-bottom"><hr class="speedbar"><table class="speedbar"><tr><td style="text-align: left; width: 15%">&nbsp;</td><td style="text-align: center"><a href="usersguide-html.html#tb:table-of-contents">Table of Contents</a> &#8212; <a href="usersguide-html6.html">References</a></td><td style="text-align: right; width: 15%"><a href="usersguide-html2.html">next</a></td></tr></table></div></body></html>
